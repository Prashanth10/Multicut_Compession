[11:32:52] Log file created: ./logs/log_20260115_113252.txt
[11:32:52] Device: cuda
[11:32:52] ======================================================================
[11:32:52] LEARNED COMPRESSION: QUANTIZED ERRORS + ENTROPY MODEL
[11:32:52] ======================================================================
[11:32:52] Total images: 800
[11:32:52] Training: 64×64 patches, 8064 edges
[11:32:52] Quantization: Divide errors by 4
[11:32:52] Entropy model: Network-learned PMF per region

[11:32:52] Ep0 B0/180 Loss=2.0107
[11:33:04] Ep0 B50/180 Loss=0.4112
[11:33:16] Ep0 B100/180 Loss=0.4261
[11:33:27] Ep0 B150/180 Loss=0.4451
[11:33:34] Ep0 DONE - Loss: 0.4984
[11:33:35] Ep1 B0/180 Loss=0.4023
[11:33:46] Ep1 B50/180 Loss=0.4248
[11:33:58] Ep1 B100/180 Loss=0.4378
[11:34:09] Ep1 B150/180 Loss=0.4085
[11:34:16] Ep1 DONE - Loss: 0.4251
[11:34:16] Ep2 B0/180 Loss=0.4159
[11:34:28] Ep2 B50/180 Loss=0.4497
[11:34:39] Ep2 B100/180 Loss=0.4087
[11:34:51] Ep2 B150/180 Loss=0.4046
[11:34:58] Ep2 DONE - Loss: 0.4117
[11:34:58] Ep3 B0/180 Loss=0.4015
[11:35:09] Ep3 B50/180 Loss=0.4035
[11:35:21] Ep3 B100/180 Loss=0.4070
[11:35:33] Ep3 B150/180 Loss=0.4004
[11:35:39] Ep3 DONE - Loss: 0.4083
[11:35:39] Ep4 B0/180 Loss=0.3971
[11:35:51] Ep4 B50/180 Loss=0.4011
[11:36:03] Ep4 B100/180 Loss=0.4004
[11:36:14] Ep4 B150/180 Loss=0.4075
[11:36:21] Ep4 DONE - Loss: 0.4073
[11:36:21] 
[VALIDATION Ep4 on image 4]
[11:36:21] [INFERENCE] Image: 2040×1608, Edges: 6,556,992
[11:36:21] [INFERENCE] Costs: Mean=0.930, Std=0.268, Min=-1.000, Max=1.000
[11:36:21] [INFERENCE] Target regions: 200
[11:36:21] [THR-SWEEP] Downsampled from 2040x1608 -> 512x404, trying 5 thresholds
[11:36:28] [GAEC] Edges in heap: 393,249
[11:36:28] [GAEC] Merges executed: 204,759
[11:36:28] [GAEC] Final regions: 2,089
[11:36:28] [MERGE] Found 2071 tiny regions (< 1000 pixels)
[11:36:28] [MERGE] Tiny regions contain: 90,097 pixels (43.6% of image)
[11:36:29] [MERGE] Merged 2071 tiny regions
[11:36:29] [MERGE] Final regions: 172
[11:36:42] [THR-SWEEP] thr=-0.900 -> size=902,336 bytes, regions=172
[11:36:49] [GAEC] Edges in heap: 382,611
[11:36:49] [GAEC] Merges executed: 204,562
[11:36:49] [GAEC] Final regions: 2,286
[11:36:49] [MERGE] Found 2270 tiny regions (< 1000 pixels)
[11:36:49] [MERGE] Tiny regions contain: 92,982 pixels (45.0% of image)
[11:36:50] [MERGE] Merged 2270 tiny regions
[11:36:50] [MERGE] Final regions: 187
[11:37:02] [THR-SWEEP] thr=-0.700 -> size=922,642 bytes, regions=187
[11:37:09] [GAEC] Edges in heap: 376,273
[11:37:09] [GAEC] Merges executed: 204,343
[11:37:09] [GAEC] Final regions: 2,505
[11:37:09] [MERGE] Found 2490 tiny regions (< 1000 pixels)
[11:37:09] [MERGE] Tiny regions contain: 94,925 pixels (45.9% of image)
[11:37:10] [MERGE] Merged 2490 tiny regions
[11:37:10] [MERGE] Final regions: 199
[11:37:22] [THR-SWEEP] thr=-0.500 -> size=949,338 bytes, regions=199
[11:37:29] [GAEC] Edges in heap: 370,849
[11:37:29] [GAEC] Merges executed: 204,069
[11:37:29] [GAEC] Final regions: 2,779
[11:37:29] [MERGE] Found 2766 tiny regions (< 1000 pixels)
[11:37:29] [MERGE] Tiny regions contain: 98,337 pixels (47.5% of image)
[11:37:30] [MERGE] Merged 2766 tiny regions
[11:37:30] [MERGE] Final regions: 216
[11:37:42] [THR-SWEEP] thr=-0.300 -> size=941,443 bytes, regions=216
[11:37:49] [GAEC] Edges in heap: 361,277
[11:37:49] [GAEC] Merges executed: 203,624
[11:37:49] [GAEC] Final regions: 3,224
[11:37:49] [MERGE] Found 3213 tiny regions (< 1000 pixels)
[11:37:49] [MERGE] Tiny regions contain: 100,908 pixels (48.8% of image)
[11:37:50] [MERGE] Merged 3213 tiny regions
[11:37:50] [MERGE] Final regions: 251
[11:38:02] [THR-SWEEP] thr=-0.100 -> size=941,919 bytes, regions=251
[11:38:02] [THR-SWEEP] BEST thr=-0.900 size=902,336 bytes @ 512x404
[11:40:01] [GAEC] Edges in heap: 6,544,317
[11:40:01] [GAEC] Merges executed: 3,276,242
[11:40:01] [GAEC] Final regions: 4,078
[11:40:02] 
[POST-PROCESS] Starting with 4,078 regions
[11:40:02] [MERGE] Found 4006 tiny regions (< 1000 pixels)
[11:40:02] [MERGE] Tiny regions contain: 121,183 pixels (3.7% of image)
[11:40:26] [MERGE] Merged 4006 tiny regions
[11:40:26] [MERGE] Final regions: 84
[11:40:26] 
[11:42:39] [INFERENCE] Final result: 84 regions, 6,839,056 bytes

[11:42:40] [VAL] Compressed=6,839,056 bytes, PNG=5,943,950 bytes, Ratio=1.151, Gain=-15.1%

